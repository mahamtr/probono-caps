<div class="edit-container">
  <div class="header">
    <h2>Edit Appointment</h2>
    <button mat-icon-button (click)="generatePDF()">
      <mat-icon>picture_as_pdf</mat-icon>
    </button>
  </div>

  <mat-card class="patient-card">
    <mat-card-header>
      <mat-card-title
        >{{ patient.firstName }} {{ patient.lastName }}</mat-card-title
      >
      <mat-card-subtitle>ID: {{ patient.idNumber }}</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <div class="patient-details">
        <div class="detail-row">
          <span class="detail-label">Date of Birth:</span>
          <span class="detail-value">{{ patient.dateOfBirth }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Civil Status:</span>
          <span class="detail-value">{{ patient.civilStatus }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Education Level:</span>
          <span class="detail-value">{{ patient.educationLevel }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Guardian:</span>
          <span class="detail-value">{{
            patient.guardianShipSection?.guardianShipName
          }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Guardian Phone:</span>
          <span class="detail-value">{{
            patient.guardianShipSection?.guardianShipPhone
          }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Major:</span>
          <span class="detail-value">{{ patient.studentSection?.major }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Study Year:</span>
          <span class="detail-value">{{
            patient.studentSection?.studyYear
          }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Phone:</span>
          <span class="detail-value">{{
            patient.contactInformation?.phoneNumber
          }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Email:</span>
          <span class="detail-value">{{ patient.email }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">House Zone:</span>
          <span class="detail-value">{{ patient.houseZone }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Program:</span>
          <span class="detail-value">{{ patient.program }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Referral:</span>
          <span class="detail-value">{{ patient.referral }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Diagnostic:</span>
          <span class="detail-value">{{ patient.diagnostic }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Second Diagnostic:</span>
          <span class="detail-value">{{ patient.secondDiagnostic }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Gender:</span>
          <span class="detail-value">{{ patient.gender }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Status:</span>
          <span class="detail-value">{{ patient.status }}</span>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <mat-card class="edit-card">
    <mat-card-content>
      <form [formGroup]="appointmentForm" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Attention Reason</mat-label>
            <input matInput formControlName="reason" />
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Family Composition</mat-label>
            <input matInput formControlName="familyComposition" />
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Mode</mat-label>
            <input matInput formControlName="mode" />
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Organic Disease</mat-label>
            <input matInput formControlName="organicDisease" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Disease Detail</mat-label>
            <input matInput formControlName="diseaseDetail" />
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Medication</mat-label>
            <input matInput formControlName="medication" />
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Treating Doctor</mat-label>
            <input matInput formControlName="treatingDoctor" />
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>History of Mental Illness</mat-label>
            <input matInput formControlName="historyOfMentalIllness" />
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Mental Illness Detail</mat-label>
            <input matInput formControlName="mentalIllnessDetail" />
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Intervention 1</mat-label>
            <select matNativeControl formControlName="interventionOne">
              <option value="">Select an intervention</option>
              <option
                *ngFor="let option of interventionOptions"
                [value]="option"
              >
                {{ option }}
              </option>
            </select>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Intervention 2</mat-label>
            <select matNativeControl formControlName="interventionTwo">
              <option value="">Select an intervention</option>
              <option
                *ngFor="let option of interventionOptions"
                [value]="option"
              >
                {{ option }}
              </option>
            </select>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Detail Attention</mat-label>
            <textarea
              matInput
              formControlName="detailAttention"
              rows="3"
            ></textarea>
          </mat-form-field>
        </div>
      </form>

      <div class="form-row">
        <!-- File Upload 1 -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Upload File 1</mat-label>
          <input
            matInput
            [value]="file1Name"
            [disabled]="!canEditAppointment"
            placeholder="No file chosen"
            readonly
          />
        </mat-form-field>

        <!-- File Input and Buttons -->
        <input
          type="file"
          #fileInput1
          (change)="onFileSelected($event, 'file1')"
          hidden
        />
        <button
          mat-icon-button
          (click)="fileInput1.click()"
          [disabled]="!!file1Name || !canEditAppointment"
          matTooltip="Choose File"
        >
          <mat-icon>attach_file</mat-icon>
        </button>
        <button
          mat-icon-button
          (click)="deleteFile('file1', $event)"
          [disabled]="!file1Name || !canEditAppointment"
          matTooltip="Delete File"
        >
          <mat-icon>delete</mat-icon>
        </button>
        <button
          mat-icon-button
          (click)="downloadFile('file1', $event)"
          [disabled]="!file1Name"
          matTooltip="Download File"
        >
          <mat-icon>cloud_download</mat-icon>
        </button>

        <!-- File Upload 2 -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Upload File 2</mat-label>
          <input
            matInput
            [value]="file2Name"
            [disabled]="!canEditAppointment"
            placeholder="No file chosen"
            readonly
          />
        </mat-form-field>

        <!-- File Input and Buttons -->
        <input
          type="file"
          #fileInput2
          (change)="onFileSelected($event, 'file2')"
          hidden
        />
        <button
          mat-icon-button
          (click)="fileInput2.click()"
          [disabled]="!!file2Name || !canEditAppointment"
          matTooltip="Choose File"
        >
          <mat-icon>attach_file</mat-icon>
        </button>
        <button
          mat-icon-button
          (click)="deleteFile('file2', $event)"
          [disabled]="!file2Name || !canEditAppointment"
          matTooltip="Delete File"
        >
          <mat-icon>delete</mat-icon>
        </button>
        <button
          mat-icon-button
          (click)="downloadFile('file2', $event)"
          [disabled]="!file2Name"
          matTooltip="Download File"
        >
          <mat-icon>cloud_download</mat-icon>
        </button>
      </div>

      <form [formGroup]="appointmentForm" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Task 1</mat-label>
            <select matNativeControl formControlName="taskOne">
              <option value="">Select a task</option>
              <option *ngFor="let option of taskOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Task 2</mat-label>
            <select matNativeControl formControlName="taskTwo">
              <option value="">Select a task</option>
              <option *ngFor="let option of taskOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Tracing</mat-label>
            <input matInput formControlName="tracing" />
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Remission Applies</mat-label>
            <input matInput formControlName="remissionApplies" />
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Destination</mat-label>
            <input matInput formControlName="destination" />
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Diagnostic 1</mat-label>
            <select matNativeControl formControlName="diagnosticOne">
              <option value="">Select a diagnostic</option>
              <option *ngFor="let option of diagnosticOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Diagnostic 2</mat-label>
            <select matNativeControl formControlName="diagnosticTwo">
              <option value="">Select a diagnostic</option>
              <option *ngFor="let option of diagnosticOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </mat-form-field>
        </div>

        <div class="form-colum">
          <mat-form-field appearance="outline">
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
              <mat-option *ngFor="let status of statuses" [value]="status">
                {{ status }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="button-row">
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="appointmentForm.invalid || !canEditAppointment"
          >
            Save Changes
          </button>
          <button
            mat-raised-button
            color="warn"
            type="button"
            (click)="onCancel()"
          >
            Cancel
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
